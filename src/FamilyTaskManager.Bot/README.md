# FamilyTaskManager Telegram Bot

Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–º–µ–π–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ —Å –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –ø–∏—Ç–æ–º—Ü–µ–≤.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ `appsettings.json` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ User Secrets:

```bash
dotnet user-secrets set "Bot:BotToken" "YOUR_BOT_TOKEN_HERE"
dotnet user-secrets set "Bot:BotUsername" "your_bot_username"
```

–ò–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `appsettings.json`:

```json
{
  "Bot": {
    "BotToken": "YOUR_BOT_TOKEN_HERE",
    "BotUsername": "your_bot_username"
  }
}
```

### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω. –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `appsettings.json`:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Database=FamilyTaskManager;Username=postgres;Password=postgres"
  }
}
```

### 4. –ó–∞–ø—É—Å–∫

```bash
dotnet run
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º / –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å–µ–º—å–µ –ø–æ invite-—Å—Å—ã–ª–∫–µ
- `/family` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–º—å—è–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ, –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è)
- `/tasks` - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
- `/pet` - –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–∏—Ç–æ–º—Ü–µ–≤ –∏ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥
- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º

## Persistent Menu (–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é)

–ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏:
- üè† –°–µ–º—å—è
- ‚úÖ –ú–æ–∏ –∑–∞–¥–∞—á–∏
- üêæ –ü–∏—Ç–æ–º–µ—Ü
- ‚≠ê –ú–æ–∏ –æ—á–∫–∏
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ë–æ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ Clean Architecture:

- **Handlers** - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ callback-–∑–∞–ø—Ä–æ—Å–æ–≤
- **Services** - –°–µ—Ä–≤–∏—Å—ã –±–æ—Ç–∞ (TelegramBotService, SessionManager)
- **Models** - –ú–æ–¥–µ–ª–∏ —Å–µ—Å—Å–∏–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- **Configuration** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞

### –°–µ—Å—Å–∏–∏

–°–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (In-Memory) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `ConcurrentDictionary`. 
–ö–∞–∂–¥–∞—è —Å–µ—Å—Å–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `CurrentFamilyId` - ID –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ–º—å–∏
- `State` - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- `Data` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤
- `LastActivity` - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ (>24 —á–∞—Å–∞) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Use Cases

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Mediator –¥–ª—è –≤—ã–∑–æ–≤–∞ Use Cases –∏–∑ —Å–ª–æ—è Application:
- `RegisterUserCommand` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `CreateFamilyCommand` - –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–º—å–∏
- `GetUserFamiliesQuery` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ–º–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò –¥—Ä—É–≥–∏–µ...

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

1. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ `CommandHandler.cs`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –º–µ—Ç–æ–¥–µ `HandleCommandAsync`
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–æ–≥–∏–∫—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Use Cases —á–µ—Ä–µ–∑ Mediator

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ callback-–¥–µ–π—Å—Ç–≤–∏—è

1. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ `CallbackQueryHandler.cs`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –º–µ—Ç–æ–¥–µ `HandleCallbackAsync`
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏

## TODO

- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã `/family` (—Å–ø–∏—Å–æ–∫ —Å–µ–º–µ–π, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ, –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è)
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã `/tasks` (—Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á, –≤–∑—è—Ç–∏–µ –≤ —Ä–∞–±–æ—Ç—É, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã `/pet` (—Å–ø–∏—Å–æ–∫ –ø–∏—Ç–æ–º—Ü–µ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è)
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã `/stats` (–ª–∏–¥–µ—Ä–±–æ—Ä–¥, –∏—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π)
- [ ] –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–¥–∞—á–∞—Ö, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –¥—Ä—É–≥–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏)
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ invite-—Å—Å—ã–ª–æ–∫
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á —Å Quartz Cron
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –¥–ª—è –∑–∞–¥–∞—á (S3/minio)
