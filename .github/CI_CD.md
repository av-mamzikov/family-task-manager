# CI/CD Pipeline

> **üÜï –û–±–Ω–æ–≤–ª–µ–Ω–æ:** –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π workflow –¥–ª—è –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ Private Registry  
> –°–º. [GITHUB_ACTIONS_SETUP.md](GITHUB_ACTIONS_SETUP.md) –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

---

# CI/CD Pipeline

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ –∏ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ GitHub Actions.

## üìã Workflows

### 1. Tests (`tests.yml`)

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**

- Push –≤ –≤–µ—Ç–∫–∏: `main`, `master`, `develop`
- Pull Request –≤ –≤–µ—Ç–∫–∏: `main`, `master`, `develop`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç .NET 9.0
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ unit —Ç–µ—Å—Ç—ã
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –æ —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

**–°—Ç–∞—Ç—É—Å:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–ª—è merge

### 2. Deploy to VPS via Private Registry (`deploy-registry.yml`) ‚≠ê **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**

- Push –≤ –≤–µ—Ç–∫–∏: `main`, `master`
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (workflow_dispatch)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. **–≠—Ç–∞–ø —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
    - ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã
    - ‚ùå –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å ‚Äî –¥–µ–ø–ª–æ–π –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

2. **–≠—Ç–∞–ø —Å–±–æ—Ä–∫–∏ –∏ push** (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏):
    - ‚úÖ –°–æ–∑–¥–∞–µ—Ç SSH —Ç—É–Ω–Ω–µ–ª—å –∫ Private Registry –Ω–∞ VPS
    - ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑
    - ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Private Registry —Å —Ç–µ–≥–∞–º–∏ (latest, commit, branch)

3. **–≠—Ç–∞–ø –¥–µ–ø–ª–æ—è:**
    - ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ VPS –ø–æ SSH
   - ‚úÖ Pull –æ–±—Ä–∞–∑–∞ –∏–∑ registry
    - ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚ö° –ë—ã—Å—Ç—Ä–µ–µ (~3 –º–∏–Ω vs ~7 –º–∏–Ω)
- üîí –ü–æ–ª–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
- üì¶ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
- üîÑ –õ–µ–≥–∫–∏–π –æ—Ç–∫–∞—Ç

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –°–º. [GITHUB_ACTIONS_SETUP.md](GITHUB_ACTIONS_SETUP.md)

**–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

---

### 2b. Deploy to VPS (Legacy) (`deploy.yml`) ‚ö†Ô∏è **–£—Å—Ç–∞—Ä–µ–≤—à–∏–π**

**–°—Ç–∞—Ç—É—Å:** –û—Ç–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

**–ú–µ—Ç–æ–¥:** Docker save/load (–º–µ–¥–ª–µ–Ω–Ω—ã–π)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∏–ª–∏ –µ—Å–ª–∏ Private Registry –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### 3. Deploy PR Preview (—á–µ—Ä–µ–∑ `deploy-registry.yml`) üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**

- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Run workflow" (workflow_dispatch)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
    - ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –¥–ª—è PR

2. **–°–±–æ—Ä–∫–∞ –∏ push:**
    - ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑ —Å —Ç–µ–≥–æ–º `pr-{number}`
    - ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Private Registry

3. **–î–µ–ø–ª–æ–π preview –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
    - ‚úÖ –°–æ–∑–¥–∞–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞ VPS
    - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ `docker-compose.prod.yml`
    - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
        - –û—Ç–¥–µ–ª—å–Ω–∞—è –ë–î (`FamilyTaskManager_PR_{number}`)
        - –¢–µ—Å—Ç–æ–≤—ã–π Telegram –±–æ—Ç (`PR_BOT_TOKEN`)
        - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
    - ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç PR —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- üîí –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –æ—Ç production
- ü§ñ –û—Ç–¥–µ–ª—å–Ω—ã–π Telegram –±–æ—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- üóÑÔ∏è –û—Ç–¥–µ–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ docker-compose —á—Ç–æ –∏ production
- üßπ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ PR

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

1. –°–æ–∑–¥–∞–π—Ç–µ PR
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Actions ‚Üí Deploy to VPS via Private Registry
3. –ù–∞–∂–º–∏—Ç–µ "Run workflow"
    - Environment: `pr-preview`
    - PR number: –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä PR
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –¥–µ–ø–ª–æ—è (~5 –º–∏–Ω)
5. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ Telegram

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –°–º. [PR_PREVIEW_USAGE.md](PR_PREVIEW_USAGE.md)

**–°—Ç–∞—Ç—É—Å:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, –ø–æ –∑–∞–ø—Ä–æ—Å—É (—á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É)

---

### 4. Cleanup PR Preview (`cleanup-pr-preview.yml`) üßπ

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**

- Pull Request –∑–∞–∫—Ä—ã—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (workflow_dispatch)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- ‚úÖ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç preview –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- ‚úÖ –£–¥–∞–ª—è–µ—Ç preview –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£–¥–∞–ª—è–µ—Ç Docker –æ–±—Ä–∞–∑—ã
- ‚úÖ –£–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç PR –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—á–∏—Å—Ç–∫–µ

**–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ PR

---

### 5. Code Coverage (`code-coverage.yml`)

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**

- Push –≤ –≤–µ—Ç–∫–∏: `main`, `master`, `develop`
- Pull Request –≤ –≤–µ—Ç–∫–∏: `main`, `master`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ PR —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ Codecov (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü–æ—Ä–æ–≥–∏:**

- üü¢ –û—Ç–ª–∏—á–Ω–æ: > 80%
- üü° –•–æ—Ä–æ—à–æ: 60-80%
- üî¥ –ü–ª–æ—Ö–æ: < 60%

### 4. Code Quality (`code-quality.yml`)

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**

- Push –≤ –≤–µ—Ç–∫–∏: `main`, `master`, `develop`
- Pull Request –≤ –≤–µ—Ç–∫–∏: `main`, `master`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (`dotnet format`)
- ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç —Å warnings as errors
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç .NET analyzers
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–¥–∞

**–°—Ç–∞—Ç—É—Å:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –¥–ª—è merge

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å CI/CD

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Pull Request

```mermaid
graph LR
    A[PR —Å–æ–∑–¥–∞–Ω] --> B[Tests]
    A --> C[Code Quality]
    A --> D[Code Coverage]
    B --> E{–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ OK?}
    C --> E
    D --> E
    E -->|–î–∞| F[–ú–æ–∂–Ω–æ –º–µ—Ä–∂–∏—Ç—å]
    E -->|–ù–µ—Ç| G[–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥]
```

1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:
    - ‚úÖ Tests
    - ‚úÖ Code Quality
    - ‚úÖ Code Coverage

2. –í PR –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞

3. –°—Ç–∞—Ç—É—Å—ã –ø—Ä–æ–≤–µ—Ä–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ PR

4. Merge –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

### –ü—Ä–∏ Push –≤ main/master

```mermaid
graph LR
    A[Push –≤ main] --> B[Tests]
    B -->|–£—Å–ø–µ—Ö| C[Build Docker]
    B -->|–ü—Ä–æ–≤–∞–ª| D[–î–µ–ø–ª–æ–π –æ—Ç–º–µ–Ω—ë–Ω]
    C --> E[Push to Docker Hub]
    E --> F[Deploy to VPS]
    F --> G[Restart containers]
```

1. –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–µ—Å—Ç—ã
2. –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã ‚Üí —Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
3. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Docker Hub
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ VPS
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±—É–µ–º—ã–µ GitHub Secrets

–î–ª—è —Ä–∞–±–æ—Ç—ã CI/CD –Ω—É–∂–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ `Settings` ‚Üí `Secrets and variables` ‚Üí `Actions`:

#### Production –¥–µ–ø–ª–æ–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

| –°–µ–∫—Ä–µ—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                  | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ    |
|---------------------|---------------------------|------------------|
| `VPS_HOST`          | IP –∞–¥—Ä–µ—Å VPS —Å–µ—Ä–≤–µ—Ä–∞      | –í—Å–µ workflows    |
| `VPS_USERNAME`      | SSH username              | –í—Å–µ workflows    |
| `VPS_SSH_KEY`       | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á        | –í—Å–µ workflows    |
| `REGISTRY_USERNAME` | Username Private Registry | Deploy workflows |
| `REGISTRY_PASSWORD` | –ü–∞—Ä–æ–ª—å Private Registry   | Deploy workflows |

#### PR Preview (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ, –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

| –°–µ–∫—Ä–µ—Ç                 | –û–ø–∏—Å–∞–Ω–∏–µ                      | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|------------------------|-------------------------------|---------------|
| `PR_BOT_TOKEN`         | –¢–æ–∫–µ–Ω —Ç–µ—Å—Ç–æ–≤–æ–≥–æ Telegram –±–æ—Ç–∞ | PR Preview    |
| `PR_BOT_USERNAME`      | Username —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –±–æ—Ç–∞       | PR Preview    |
| `PR_POSTGRES_USER`     | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î –¥–ª—è PR        | PR Preview    |
| `PR_POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î –¥–ª—è PR              | PR Preview    |

#### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ)

| –°–µ–∫—Ä–µ—Ç            | –û–ø–∏—Å–∞–Ω–∏–µ                     | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-------------------|------------------------------|---------------|
| `CODECOV_TOKEN`   | –¢–æ–∫–µ–Ω Codecov                | Code Coverage |
| `DOCKER_USERNAME` | Username Docker Hub (legacy) | Legacy deploy |
| `DOCKER_PASSWORD` | –ü–∞—Ä–æ–ª—å Docker Hub (legacy)   | Legacy deploy |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Branch Protection Rules

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞—â–∏—Ç—É –≤–µ—Ç–∫–∏ `main`:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Settings` ‚Üí `Branches`
2. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è `main`
3. –í–∫–ª—é—á–∏—Ç–µ:
    - ‚úÖ Require status checks to pass before merging
    - ‚úÖ Require branches to be up to date before merging
    - ‚úÖ Status checks: `Run Tests`
    - ‚úÖ Require pull request reviews before merging

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ workflows

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É `Actions`
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π workflow

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π workflow run
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Summary`
3. –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã `test-results`

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

1. –í Pull Request —Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç –±–æ—Ç–∞
2. –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ workflow `Code Coverage` ‚Üí `Summary`

## üîß –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ push

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
dotnet test
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
dotnet format --verify-no-changes
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
dotnet format
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º

```bash
dotnet test --collect:"XPlat Code Coverage"
```

### –°–±–æ—Ä–∫–∞ —Å warnings as errors

```bash
dotnet build /p:TreatWarningsAsErrors=true
```

## üöÄ –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –±–µ–∑ push:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Actions`
2. –í—ã–±–µ—Ä–∏—Ç–µ `Deploy to VPS`
3. –ù–∞–∂–º–∏—Ç–µ `Run workflow`
4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É
5. –ù–∞–∂–º–∏—Ç–µ `Run workflow`

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

- **Code Coverage**: > 80%
- **Build Success Rate**: > 95%
- **Deployment Success Rate**: > 99%
- **Test Pass Rate**: 100%

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫

–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–∞–∑–¥–µ–ª–µ `Insights` ‚Üí `Actions`:

- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflows
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω—É—Ç GitHub Actions

## üêõ Troubleshooting

### –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –≤ CI, –Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –ª–æ–∫–∞–ª—å–Ω–æ

**–ü—Ä–∏—á–∏–Ω—ã:**

- –†–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ .NET
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ PostgreSQL –ª–æ–∫–∞–ª—å–Ω–æ
- –†–∞–∑–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å —Ç–æ–π –∂–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π, —á—Ç–æ –≤ CI
docker run --rm -d -p 5432:5432 \
  -e POSTGRES_DB=FamilyTaskManager_Test \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres_test_password \
  postgres:16-alpine

export ConnectionStrings__DefaultConnection="Host=localhost;Port=5432;Database=FamilyTaskManager_Test;Username=postgres;Password=postgres_test_password"
dotnet test
```

### –î–µ–ø–ª–æ–π –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**

1. –í—Å–µ –ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã?
2. –ü—Ä–æ—à–ª–∏ –ª–∏ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ?
3. –ï—Å—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø –∫ VPS –ø–æ SSH?

**–û—Ç–ª–∞–¥–∫–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh -i ~/.ssh/github-actions root@–≤–∞—à_vps_ip

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ VPS
ssh root@–≤–∞—à_vps_ip "docker compose -C /opt/family-task-manager logs"
```

### Code Coverage –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ—Å—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç coverage
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º coverage
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç `coverlet.collector` –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ

### Workflow –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ workflows –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
3. –£–º–µ–Ω—å—à–∏—Ç–µ verbosity –ª–æ–≥–æ–≤

## üìù –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### Commits

- ‚úÖ –î–µ–ª–∞–π—Ç–µ –Ω–µ–±–æ–ª—å—à–∏–µ, –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã
- ‚úÖ –ü–∏—à–∏—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ commit messages
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ push

### Pull Requests

- ‚úÖ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ PR –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∏—á–∏
- ‚úÖ –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–µ—Ä–µ–¥ merge
- ‚úÖ –ó–∞–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ code review

### –î–µ–ø–ª–æ–π

- ‚úÖ –î–µ–ø–ª–æ–π—Ç–µ —Ç–æ–ª—å–∫–æ –∏–∑ `main` –≤–µ—Ç–∫–∏
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [.NET Testing Best Practices](https://learn.microsoft.com/en-us/dotnet/core/testing/)
- [Docker Build Best Practices](https://docs.docker.com/develop/dev-best-practices/)
- [Codecov Documentation](https://docs.codecov.com/)

## üìä –°—Ç–∞—Ç—É—Å Badges

–î–æ–±–∞–≤—å—Ç–µ –≤ README.md:

```markdown
![Tests](https://github.com/–≤–∞—à_username/–≤–∞—à_repo/workflows/Tests/badge.svg)
![Deploy](https://github.com/–≤–∞—à_username/–≤–∞—à_repo/workflows/Deploy%20to%20VPS/badge.svg)
![Code Coverage](https://codecov.io/gh/–≤–∞—à_username/–≤–∞—à_repo/branch/main/graph/badge.svg)
```

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π push –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è, –∞ –¥–µ–ø–ª–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤. üéâ
